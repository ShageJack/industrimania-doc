# 蒸汽动力

基于做功、焓值、压强、温度的真实蒸汽系统

1. 管道内的蒸汽不是Forge流体，数据保存在管道中

2. 蒸汽根据温度、压强的不同可以转化为不同的Forge流体

3. 管道内蒸汽的压强、温度都会随蒸汽在管道内流动改变

4. 红石控制的限压阀、限流阀

5. 超压导致管道损坏甚至爆炸，过热蒸汽泄露

6. 蒸汽分为饱和蒸汽和过热蒸汽

   

1L（1000mb）水能产生1kg蒸汽（不要问为啥）



## 蒸汽包

蒸汽在蒸汽容器内会以蒸汽包形式存储

蒸汽包会不断地自然散热，在温度$T$过低后（$T<373.15K$）开始快速损失质量$M$，$当M=0$时蒸汽包消失

蒸汽包有三个主要属性：质量$M$，温度$T$和状态$S$

状态分为饱和蒸汽（saturated steam）和过热蒸汽（superheated steam）

两者都有不变的基础焓$2000KJ/KG$

饱和蒸汽继续吸热会转变为过热蒸汽，过热蒸汽放热会转变为饱和蒸汽

这部分的热被称为汽化相变焓（也称汽化潜热）$Q_{p}$

基础焓与潜热相加为总基础焓$Q_{\alpha}$

而蒸汽的焓值（全热焓）表示为$H$

蒸汽密度为$\rho$

蒸汽体积为$V$

一定条件下饱和蒸汽的含水质量为$M_w$

蒸汽包的包负载$L_p$

压强$p$符合
$$
T_r = \frac{T}{647}\\
\alpha = 9.57\\
\beta = 5.40\\
\gamma = -6.16\\
\delta = 1.496\\
\epsilon = 0.433\\
\ln{p_0} = \alpha + \beta \ln{T_r} + \gamma (\ln{T_r})^2 + \delta  (\ln{T_r})^4 + \epsilon T_r^5, MPa, \ln{p} < 11 \\
p = \frac{p_0}{1000}, S= \text{saturated steam} \\
p = \frac{3p_0}{2500}, S= \text{superheateded steam}
$$
密度$\rho$符合
$$
a= 0.16946\\
b = 3.8232\\
c = 1.1946\\
\rho = {ap^2 + bp + c}\\
$$
则显然
$$
V = \frac{M}{\rho}
$$
包负载$L_p$符合
$$
L_p = Vp
$$


饱和蒸汽含水量$M_w$符合
$$
M_w = \frac{220pM}{T\rho}
$$


汽化相变焓$Q_p$符合
$$
T_c = -10 + \frac{T}{100} \\
\mu = -209.5\\
\nu = 39015\\
\theta_5 = -14.682\\
\theta_4 = -395.8 \\
\theta_3 = -4398.8\\
\theta_2 = -24286.5 \\
\theta_1 = -70322.5 \\
\theta_0 = -347946\\
Q_p = e^{\mu + \frac{T}{3}}+\nu\ln T + \theta_5 T_c^5+\theta_4 T_c^4+\theta_3 T_c^3+\theta_2 T_c^2+\theta_1 T_c+\theta_0 ,KJ/KG,273.15K < T < 647.1K
$$


焓值$H$符合
$$
H = Q_{\alpha} + 2T\\
Q_{\alpha} = 2000KJ/kg, S =\text{saturated steam} \\
Q_{\alpha} = 2000 + Q_p M_w / M,KJ/Kg, S =\text{superheated steam}\\
$$


## 蒸汽包的传输

对于封闭的蒸汽系统，蒸汽包会向相邻的包负载$L_p$较低的方向传输

传输的具体实现方式为，当可传输方向为$N$个时，将蒸汽包本身分割为温度$T$不变，质量$M'$为$\frac{M}{N+1}$的$N+1$个蒸汽包，其中一个留在当前蒸汽容器内，其它每个分别传输到可传输方向的容器内，或同其中的蒸汽进行合并

## 蒸汽包的合并

蒸汽包在合并时，得到的新蒸汽包称为合并蒸汽包

合并蒸汽包的质量相加得到$M_2$，蒸汽温度$T_2$为合并各包的加权平均，即
$$
T_2 = \frac{M_0 T_0 + M_1 T_1}{M_0 + M_1}
$$
若同为过热蒸汽或饱和蒸汽，不发生相变

若为不同状态的蒸汽，则此时根据合并各包，计算合并蒸汽包的相变焓$Q_2$
$$
{Q_2} = \frac{Q_s M_s + Q_o M_o}{M_s + M_o}
$$
其中$Q_s$为饱和蒸汽包对应的相变焓，$Q_o$为过热蒸汽包对应的相变焓，$M_s$为饱和蒸汽包对应的质量，$M_o$为过热蒸汽包对应的质量

并计算合并蒸汽包为过热蒸汽时的潜热$Q_p$

若有$Q_2 \geq Q_p$，则合并蒸汽包为过热蒸汽，否则为饱和蒸汽

值得注意的是，这样的合并必然造成蒸汽潜热的浪费

## 蒸汽释放到世界中

### 蒸汽实体

释放到世界中的蒸汽是一种实体，该实体继承被释放的蒸汽包的属性质量$M$和温度$T$，分为饱和蒸汽实体和过热蒸汽实体

蒸汽实体在被释放时一般具有初始速度向量$v$，其大小符合
$$
v= 500\sqrt{\frac{p}{\rho}},m/s
$$


蒸汽实体在移动时每tick损失$25\%$的速度

由于Minecraft每tick进行一次计算（$1s=20tick$）故Minecraft世界的时间是离散的，

我们可以计算得到在无任何阻挡的情况下蒸汽可以喷出的距离为
$$
x=\sum _{t=0}^{\infty } \frac{0.75^t v}{20} = 0.2v
$$
另外我们还可以得到$T=231.97K$时，$v$和$x$有最大值$v=223.546m/s, x=44.7m$

蒸汽实体会不断散热，散热速度是蒸汽容器中自然散热速度的10倍

在温度$T$过低后（$T<373.15K$）开始快速损失质量$M$，$当M=0$时蒸汽包消失

不论哪种蒸汽实体，当$T>353.15K$时，生物接触该实体时都会持续受到伤害，接触的具体范围为以蒸汽实体为中心的球状区域，半径为$R$，有
$$
R=10\sqrt[3]{\frac{3V}{4π}}
$$

### 饱和蒸汽

饱和蒸汽是一种高温雾状白色实体

饱和蒸汽在撞到水以外的方块时（半径内有方块）会立即损失全部速度，若遇到水，会将半径内的所有水蒸发，并一次性失去$25\%$的速度和$10\%$的温度

其他生物接触饱和蒸汽时，每tick受到的伤害可以用以下公式计算
$$
X= \lfloor \frac{\sqrt M(T-353.15)}{10} \rfloor
$$


然而，由于生物本身受到攻击后10tick的伤害免疫时间的存在，蒸汽并不会每tick都对实体造成伤害，而是0.5秒造成一次伤害（但是接触的瞬间就会受到伤害）

### 过热蒸汽

过热蒸汽是一种极度危险的高温透明实体

它对生物造成的伤害是饱和蒸汽的5倍，且无视护甲和火焰抗性（虚空伤害），另外，它还会对其他所有实体也造成伤害，例如掉落物

若$T>523.15K$，它会点燃半径范围内的所有包括生物在内的实体，并尝试点燃半径范围内的所有方块

若$T>723.15K$，当它的半径内有水时，它会立刻蒸发半径内的全部水，并一次性失去$5\%$的速度和$5\%$的温度

若$T>723.15K$，当它的半径内有非空气、火或水的方块时，它会立刻蒸发半径内的硬度小于$50$（黑曜石）或爆炸抗性小于$1200$（黑曜石）的所有方块，并一次性失去$20\%$的速度和$5\%$的温度

## 蒸汽容器

所以的蒸汽容器都有四个参数，最大流量$V_{max}$，最大压强$p_{max}$，最大承受能力$L_{max}$和耐久度$D$

当蒸汽容器内蒸汽包对应参数超过$V_{max},p_{max},L_{max}$中任意一个时，蒸汽容器都会降低耐久度，每个过高的参数$X$贡献的耐久$D$降低速度同$X-X_{max}$正相关

当$D\leq0$时，该蒸汽容器会爆炸并将内部蒸汽包分成随机份朝随机的方向释放

蒸汽容器被破坏时会直接释放内部的蒸汽包

所有的蒸汽容器方块需要实现三个方法：

#boolean manageSteamStored() - 处理当前容器内的蒸汽包，返回值代表容器是否爆炸

#void manageTransfer() - 进行蒸汽包的传输

#void explode() - 爆炸

## 管道

管道是一种蒸汽容器

它根据材料和大小有不同的属性

管道按形状分为几种

直管，L形管，T形三通管，十字四通管，立体五通管，立体六通管

开口的方向的蒸汽容器会被自动连接

若开口方向不是完整方块又不是蒸汽容器，则将管道内蒸汽包按本身加上所有的可传输方向数量（包括非蒸汽容器开口）等分，并向非蒸汽容器开口方向释放其中一份蒸汽包到世界中，具体同蒸汽包的正常传输相同

## 锅炉

锅炉是一种能够通过加热水产生蒸汽的蒸汽容器，也是一种蒸汽源

对于锅炉，锅炉会在温度足够高（取决于锅炉性质）时产生饱和蒸汽包

新蒸汽包的最大质量$M_n$与锅炉温度$T_b$和锅炉蒸发常数$C_v$有关

新蒸汽包温度$T_{n}$与锅炉温度$T_b$和锅炉导热常数$C_h$有关

一般地
$$
M_n = \frac{\lfloor \frac{T_b}{C_v}\rfloor}{1000} \\
T_n = 373.15 + (T_b - 373.15)^{C_h}
$$
对于低压锅炉，$C_v=400,C_h=0.84$

若锅炉内已有蒸汽，新的蒸汽包在产生后将立即与锅炉内蒸汽包合并



另外，当锅炉温度高于蒸汽温度时，锅炉内蒸汽还会从锅炉吸热

吸热$Q$与锅炉产热常数$C_p$和锅炉温度$T_b$有关，满足
$$
Q=\frac{T_b}{C_p}
$$
吸热过程会使蒸汽的温度上升$\Delta T$，与蒸汽质量$M$，吸热$Q$和锅炉效率常数$C_e$有关，满足
$$
\Delta T = \frac {C_e Q}{M}， C_e < 2
$$
当锅炉内蒸汽为饱和蒸汽时，若
$$
\Delta T > Q_p M_w
$$
则蒸汽转化为过热蒸汽

对于低压锅炉，$C_p = 100, C_e = 0.4$

吸热后锅炉会损失这部分热量

在这个过程中，蒸汽不能被加热到超过$873.15K$（虽然此时的压强为$0.292GPa$，在那之前容器应该已经爆掉了）

下面是$Q_p$关于$T$的图像（$373.15K < T < 647.1K$）

![(Plot)Q_r-T]((Plot)Q_r-T.png)

可以看到，$Q_p$随温度$T$的升高下降，在$373.15K < T < 550K$时接近线性，而在$T>550K$时呈指数下降，在$T=647.1K$时，$Q_p = 0KJ/KG$，这意味着继续吸热蒸汽必然会变成过热蒸汽，所以，一般地，不存在$T>647.1K$的饱和蒸汽。

$Q_p$的下降会使饱和蒸汽转换为过热蒸汽这一过程更容易，对于同一锅炉，质量相同的蒸汽包会在一定的温度下转变为过热蒸汽，这一温度与蒸汽包质量正相关。

## 各类蒸汽阀

### 限流阀

限流阀是一种特殊的蒸汽容器，有可调节的属性$V_{c} \leq V_{max}$，且其只有在内部$V \leq V_{c}$时才会向外部传输蒸汽

当限流阀内蒸汽包$V>V_c$时，限流阀会强制降低蒸汽包的质量$M$，使$V \leq V_c$，多余的蒸汽会单独作为蒸汽包向指定方向释放到世界中

注意，释放高温（$T>723.15K$）的过热蒸汽极端危险，很可能会破坏掉整个管道系统

### 限压阀

限压阀是一种特殊的蒸汽容器，有可调节的属性$p_{c} \leq p_{max}$，且其只有在内部$p \leq p_{c}$时才会向外部传输蒸汽

当限流阀内蒸汽包$p>p_c$时，限流阀会直接释放内部存储的整个蒸汽包向指定方向释放到世界中

注意，释放高温（$T>723.15K$）的过热蒸汽极端危险，很可能会破坏掉整个管道系统

### 止回阀

止回阀是一种特殊的蒸汽容器，它只会向指定的一个方向传输蒸汽

## 蒸汽做功

单个蒸汽包做功
$$
W = ηM(H-H_1),KJ
$$
额定功率为
$$
P = ηpM,KW
$$

$$
H_1 = Q_{\alpha} + (2 -\frac{p}{40})T,KJ/KG,\text{ as saturated steam}\\
$$

可以看到，低压情况下，一次做功中，对于饱和蒸汽，只有相当小的一部分能量（当$p=1MPa$时仅利用了$\frac{1}{80}$）被利用了（而且还要计算蒸汽机械本身的效率），而对于过热蒸汽，因为$H_1$的$Q_\alpha$按饱和蒸汽计，故一次做功中利用的能量会更多

这对于前期的蒸汽机器来说是非常糟糕的，因为前期的蒸汽机器只能通过排出蒸汽时，将蒸汽的压力势能转化为动能来进行一次做功，蒸汽在一次做功后会被完全浪费，一个解决办法是进一步提高压强，但是这对前期的蒸汽机器又是不可能的

能够制造出高压蒸汽容器后，提高蒸汽压强是一个解决方法，另外还可以使用更先进的热机，这能让你有限地增加蒸汽做功的次数，但这一般不会允许你利用超过$50\%$的蒸汽内能

## 低效能蒸汽机器

低效能蒸汽机器是一类蒸汽容器，通过将蒸汽的压力势能转化为动能进行一次做功来利用蒸汽能量

它会将做功后的蒸汽直接从排气口释放到世界中

注意，释放高温（$T>723.15K$）的过热蒸汽极端危险

## 蒸汽机

蒸汽机是一类蒸汽容器，能够让蒸汽多次做功，将蒸汽的内能转换为动能并向外输出，它对蒸汽内能的利用率一般不会超过$50\%$

它会将多次做功后的蒸汽直接从排气口释放到世界中

注意，释放高温（$T>723.15K$）的过热蒸汽极端危险，但是一般蒸汽机释放的蒸汽不会处于高温状态

## 动力机器

动力机器并不是蒸汽容器，它们通过蒸汽机或别的动力源提供的机械能工作

动力机械在工作时一般对转速和扭矩有一定要求

## 各类蒸汽机器（单方块或多方块的）

1. 1. 蒸汽泵
   2. 小型燃煤蒸汽锅炉
   3. 立式燃煤蒸汽锅炉（多方块，高度可变）
   4. 蒸汽锻造锤（多方块）
   5. 蒸汽球磨床（多方块）
   6. 蒸汽筛分机（多方块）
   7. 蒸汽洗矿机（多方块）
   8. 蒸汽车床（多方块）
   9. 低压蒸汽涡轮（多方块，提供电力，电压等级：LV）
   10. 高压蒸汽涡轮（多方块，提供电力，电压等级：MV）